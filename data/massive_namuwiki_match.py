"""
ë‚˜ë¬´ìœ„í‚¤ ëŒ€ëŸ‰ ì œëª© ë§¤ì¹­ (ã…ˆ, ã…‡, ã……, ã… ì´ˆì„±)
ìë™ ë§¤ì¹­ ì•Œê³ ë¦¬ì¦˜ ì‚¬ìš©
"""
import sqlite3
import re

DB_PATH = '/Users/gimseojun/Documents/Git_Projects/anipass/data/anime.db'

# ë‚˜ë¬´ìœ„í‚¤ì—ì„œ ì¶”ì¶œí•œ ëª¨ë“  ì œëª©
NAMU_TITLES = [
    # ã…ˆ ì´ˆì„±
    'ìì´ì–¸íŠ¸ ë¡œë³´', 'ì‘ì•ˆì˜ ìƒ¤ë‚˜', 'ì”í–¥ì˜ í…ŒëŸ¬', 'ì¥ë‚œì„ ì˜ ì¹˜ëŠ” íƒ€ì¹´ê¸° ì–‘',
    'ì¥ì†¡ì˜ í”„ë¦¬ë Œ', 'ì¬ì™€ í™˜ìƒì˜ ê·¸ë¦¼ê°ˆ', 'ì „êµ­ ë°”ì‚¬ë¼', 'ì „ë‡Œ ì½”ì¼',
    'ì „ì„¤ì˜ ìš©ìì˜ ì „ì„¤', 'ì „ìƒí–ˆë”ë‹ˆ ìŠ¬ë¼ì„ì´ì—ˆë˜ ê±´ì— ëŒ€í•˜ì—¬', 'ì „ì¥ì˜ ë°œíë¦¬ì•„',
    'ì „íŒŒë…€ì™€ ì²­ì¶˜ë‚¨', 'ì ˆëŒ€ê°€ë ¨ ì¹ ë“œëŸ°', 'ì ˆì›ì˜ í…œí˜ìŠ¤íŠ¸', 'ì •ë ¹ì‚¬ì˜ ê²€ë¬´',
    'ì •ë ¹ì˜ ìˆ˜í˜¸ì', 'ì œë¡œë¶€í„° ì‹œì‘í•˜ëŠ” ë§ˆë²•ì˜ ì„œ', 'ì œë¡œì˜ ì‚¬ì—­ë§ˆ',
    'ì¡°ì´ë“œ ì‹ ì„¸ê¸° ìŠ¬ë˜ì‰¬ ì œë¡œ', 'ì¢€ë¹„ ëœë“œ ì‚¬ê°€', 'ì¢…ë§ì˜ ì„¸ë¼í”„', 'ì¢…ë§ì˜ ì´ì œíƒ€',
    'ì£¼ë¬¸ì€ í† ë¼ì…ë‹ˆê¹Œ?', 'ì£¼ìˆ íšŒì „', 'ì¤‘2ë³‘ì´ë¼ë„ ì‚¬ë‘ì´ í•˜ê³  ì‹¶ì–´!', 'ì§€ê¸ˆ, ê±°ê¸°ì— ìˆëŠ” ë‚˜',
    'ì§€ë°•ì†Œë…„ í•˜ë‚˜ì½” êµ°', 'ì§€ì˜¥ì†Œë…€', 'ì§€íŒ¡ì´ì™€ ê²€ì˜ ìœ„ìŠ¤í† ë¦¬ì•„', 'ì§„ê²©ì˜ ê±°ì¸',
    'ì§„ê²©! ê±°ì¸ ì¤‘í•™êµ',

    # ã…‡ ì´ˆì„± (ì£¼ìš” ì‘í’ˆë§Œ)
    'ì•„ë‹¤ì¹˜ì™€ ì‹œë§ˆë¬´ë¼', 'ì•„ë¼ì¹´ì™€ ì–¸ë” ë” ë¸Œë¦¬ì§€', 'ì•„ë¥´ìŠ¬ë€ ì „ê¸°', 'ì•„ë§ˆê°€ë¯¸ SS',
    'ì•„ë§ˆê¸° ë¸Œë¦´ë¦¬ì–¸íŠ¸ íŒŒí¬', 'ì•„ì‹œì•„ë¼ì´ ì €íƒì˜ ì£¼ë¯¼ë“¤', 'ì•„ì›ƒë¸Œë ˆì´í¬ ì»´í¼ë‹ˆ',
    'ì•„ì´ëŒ ë§ˆìŠ¤í„°', 'ì•„ì´ëŒ ë§ˆìŠ¤í„° ì‹ ë°ë ë¼ ê±¸ì¦ˆ', 'ì•„ì´ì‹¤ë“œ 21', 'ì•„ì´ì¦ˆ', 'ì•„ì´ì¹´ì¸ !',
    'ì•„ì¦ˆë§ê°€ ëŒ€ì™•', 'ì•„ì¹´ë©”ê°€ ë²¤ë‹¤!', 'ì•„í”ˆ ê±´ ì‹«ìœ¼ë‹ˆê¹Œ ë°©ì–´ë ¥ì— ì˜¬ì¸í•˜ë ¤ê³  í•©ë‹ˆë‹¤',
    'ì•…ë§ˆì˜ ë¦¬ë“¤', 'ì•ˆë…• ì ˆë§ì„ ìƒ', 'ì•Œë“œë…¸ì•„. ì œë¡œ', 'ì•Œë°” ë›°ëŠ” ë§ˆì™•ë‹˜!',
    'ì•”ì‚´êµì‹¤', 'ì•¡ì…€ ì›”ë“œ', 'ì•±ì†”ë£¨íŠ¸ ë“€ì˜¤', 'ì•¼ë§ˆë…¸ìŠ¤ìŠ¤ë©”', 'ì•¼ë§ˆë‹¤ì™€ 7ëª…ì˜ ë§ˆë…€',
    'ì•½ì†ì˜ ë„¤ë²„ëœë“œ', 'ì–´ë‚˜ë”', 'ì–´ë‘ ê³¼ ëª¨ìì™€ ì±…ì˜ ì—¬í–‰ì', 'ì–´ë–¤ ë§ˆìˆ ì˜ ê¸ˆì„œëª©ë¡',
    'ì–´ë–¤ ê³¼í•™ì˜ ì´ˆì „ìí¬', 'ì–´ì„œ ì˜¤ì„¸ìš” ì‹¤ë ¥ì§€ìƒì£¼ì˜ êµì‹¤ì—', 'ì–¸ë•ê¸¸ì˜ ì•„í´ë¡ ',
    'ì–¸ì–´ì˜ ì •ì›', 'ì—”ì ¤ ë¹„íŠ¸!', 'ì—˜íœë¦¬íŠ¸', 'ì—¬ê³ ìƒ ë°”ë³´êµ°ë‹¨', 'ì—¬ê¸°ëŠ” ì˜ë‚˜ê°€ëŠ” íŒŒì¶œì†Œ',
    'ì—­ê²½ë¬´ë¢° ì¹´ì´ì§€', 'ì—­ì‹œ ë‚´ ì²­ì¶˜ ëŸ¬ë¸Œì½”ë©”ë””ëŠ” ì˜ëª»ëë‹¤', 'ì˜¤! ë‚˜ì˜ ì—¬ì‹ ë‹˜',
    'ì˜¤ë€ê³ êµ ì‚¬êµí´ëŸ½', 'ì˜¤ë²„ë¡œë“œ', 'ì˜¤ì†Œë§ˆì¸  ìƒ', 'ì˜¤íƒ€ì¿ ì—ê²Œ ì‚¬ë‘ì€ ì–´ë ¤ì›Œ',
    'ì˜¨ë¼ì¸ ê²Œì„ì˜ ì‹ ë¶€ëŠ” ì—¬ìì•„ì´ê°€ ì•„ë‹ˆë¼ê³  ìƒê°í•œ ê±°ì•¼?', 'ì™„ê°„ ë¯¸ë“œë‚˜ì´íŠ¸',
    'ì™•ì‹¤êµì‚¬ í•˜ì´ë„¤', 'ìš”ê´´ì›Œì¹˜', 'ìš”ë¥´ë¬¸ê°„ë“œ', 'ìš”ìˆ ê³µì£¼ ìƒë¦¬', 'ìš©ìê°€ ë˜ì§€ ëª»í•œ ë‚˜ëŠ” ë§ˆì§€ëª»í•´ ì·¨ì§ì„ ê²°ì‹¬í–ˆìŠµë‹ˆë‹¤',
    'ìš°ë¼ë¼ ë¯¸ë¡œì²©', 'ìš°ë§ˆë¬´ìŠ¤ë©” í”„ë¦¬í‹° ë”ë¹„', 'ìš°ì£¼í˜•ì œ', 'ìš¸ë ¤ë¼! ìœ í¬ë‹ˆì—„',
    'ì›í€ë§¨', 'ì›í”¼ìŠ¤', 'ì›”ê°„ìˆœì • ë…¸ìí‚¤ êµ°', 'ì›”ë“œ íŠ¸ë¦¬ê±°', 'ìœ ë…€ì „ê¸°', 'ìœ ë£¨ìœ ë¦¬',
    'ìœ ë£¨ìº í”„', 'ìœ ë¦¬!!! on ICE', 'ìœ ìœ ë°±ì„œ', 'ìœ í¬ì™•', 'ì€ìˆ˜ì € Silver Spoon',
    'ì€í•˜ì˜ì›…ì „ì„¤', 'ì€í•˜ì² ë„ 999', 'ì€í˜¼', 'ì´ë‚˜ì¦ˆë§ˆ ì¼ë ˆë¸', 'ì´ëˆ„ì•¼ìƒ¤',
    'ì´ ë©‹ì§„ ì„¸ê³„ì— ì¶•ë³µì„!', 'ì´ì„¸ê³„ ì‹ë‹¹', 'ì´ì„¸ê³„ëŠ” ìŠ¤ë§ˆíŠ¸í°ê³¼ í•¨ê»˜',
    'ì´ì„¸ê³„ ë§ˆì™•ê³¼ ì†Œí™˜ ì†Œë…€ì˜ ë…¸ì˜ˆ ë§ˆìˆ ', 'ì´ì•¼ê¸° ì‹œë¦¬ì¦ˆ', 'ì´ì›ƒì§‘ í† í† ë¡œ',
    'ì´ìœ½ê³  ë„¤ê°€ ëœë‹¤', 'ì¸ë¥˜ëŠ” ì‡ í‡´í–ˆìŠµë‹ˆë‹¤', 'ì¼ê³± ê°œì˜ ëŒ€ì£„', 'ì¼ê¸°ë‹¹ì²œ', 'ì¼ìƒ',
    'ì„ê¸ˆë‹˜ ë­í‚¹',

    # ã…… ì´ˆì„± (ì£¼ìš” ì‘í’ˆë§Œ)
    'ì‚¬ë‘ê³¼ ê±°ì§“ë§', 'ì‚¬ë‘ê³¼ ì„ ê±°ì™€ ì´ˆì½œë¦¿', 'ì‚¬ë‘ì€ ë¹„ê°€ ê°  ë’¤ì²˜ëŸ¼', 'ì‚¬ë¬´ë¼ì´ 7',
    'ì‚¬ë¬´ë¼ì´ ì°¸í”„ë£¨', 'ì‚¬ë¬´ë¼ì´ í”Œë¼ë©©ì½”', 'ì‚¬ìƒìµœê°•ì˜ ì œì ì¼„ì´ì¹˜', 'ì‚¬ì´ë³´ê·¸ 009',
    'ì‚¬ì´ì½” íŒ¨ìŠ¤', 'ì‚¬ì´í‚¤ ì¿ ìŠ¤ì˜¤ì˜ ì¬ë‚œ', 'ì‚¬ì¹´ëª¨í† ì…ë‹ˆë‹¤ë§Œ?', 'ì‚¬í‚¤', 'ì‚¬ì¿ ë¼ ëŒ€ì „',
    'ì‚¬ì¿ ë¼ í€˜ìŠ¤íŠ¸', 'ì‚¬ì¿ ë¼ íŠ¸ë¦­', 'ì‚¬ì¿ ë¼ì¥ì˜ ì• ì™„ ê·¸ë…€', 'ì‚°ì¹´ë ˆì•„', 'ì‚´ìœ¡ì˜ ì²œì‚¬',
    'ì‚¼ìì‚¼ì—½', 'ìƒˆë²½ì˜ ì—°í™”', 'ìƒ¤ë¨¼í‚¹', 'ìƒ¤ë¥¼ë¡œíŠ¸', 'ìƒ¹ê·¸ë¦¬ë¼', 'ì„€ë„ í•˜ìš°ìŠ¤',
    'ì„¬ê´‘ì˜ ë‚˜ì´íŠ¸ë ˆì´ë“œ', 'ì„¬ë€ ì¹´êµ¬ë¼', 'ì„±ê²€ì‚¬ì˜ ê¸ˆì£¼ì˜ì°½', 'ì„¸ê¸°ë§ ì˜¤ì»¬íŠ¸ í•™ì›',
    'ì„¸ê³„ì •ë³µ ~ëª¨ëµì˜ ì¦ˆë² ì¦ˆë‹¤~', 'ì„¸ì´ë Œ', 'ì„¸ì¸íŠ¸ ì„¸ì´ì•¼', 'ì„¸ì¼ëŸ¬ ë¬¸',
    'ì„¸í‚¤ë ˆì´', 'ì„¸í† ì˜ ì‹ ë¶€', 'ì„¼ê³¼ ì¹˜íˆë¡œì˜ í–‰ë°©ë¶ˆëª…', 'ì†Œë…€ì¢…ë§ì—¬í–‰', 'ì†Œë…€í˜ëª… ìš°í…Œë‚˜',
    'ì†Œë…„íƒì • ê¹€ì „ì¼', 'ì†Œë“œ ì•„íŠ¸ ì˜¨ë¼ì¸', 'ì†Œìš¸ ì´í„°', 'ì‡¼ì™€ ê²ë¡œì¿  ë¼ì¿ ê³  ì‹¬ì¤‘',
    'ìˆ˜í˜¸ìºë¦­í„°', 'ìŠˆíƒ€ì¸ì¦ˆ ê²Œì´íŠ¸', 'ìŠ¤ë°”ë£¨', 'ìŠ¤ì¦ˆë¯¸ì•¼ í•˜ë£¨íˆì˜ ìš°ìš¸', 'ìŠ¤ì¼“ ëŒ„ìŠ¤',
    'ìŠ¤ì¿¨ëŸ¼ë¸”', 'ìŠ¤í¬ë¼ì´ë“œ', 'ìŠ¤íƒ€ë®¤', 'ìŠ¤íŠ¸ë¼ì´í¬ ìœ„ì¹˜ìŠ¤', 'ìŠ¤íŒŒì´ êµì‹¤',
    'ìŠ¤íŒŒì´ íŒ¨ë°€ë¦¬', 'ìŠ¬ë¨ë©í¬', 'ìŠ¬ë ˆì´ì–´ì¦ˆ', 'ì‹œê°„ì„ ë‹¬ë¦¬ëŠ” ì†Œë…€', 'ì‹œê·€',
    'ì‹œëŒë³„ ë…€ì„ë“¤', 'ì‹œë„ë‹ˆì•„ì˜ ê¸°ì‚¬', 'ì‹œë¡œë°”ì½”', 'ì‹œì›ì°®ì€ ê·¸ë…€ë¥¼ ìœ„í•œ ìœ¡ì„±ë°©ë²•',
    'ì‹ê·¹ì˜ ì†Œë§ˆ', 'ì‹ ê²©ì˜ ë°”í•˜ë¬´íŠ¸', 'ì‹ ë§Œì´ ì•„ëŠ” ì„¸ê³„', 'ì‹ ë¹„í•œ ë°”ë‹¤ì˜ ë‚˜ë””ì•„',
    'ì‹ ì„¸ê³„ì—ì„œ', 'ì‹ ì„¸ê¸° ì—ë°˜ê²Œë¦¬ì˜¨', 'ì‹ ì˜ íƒ‘', 'ì‹­ì´êµ­ê¸°', 'ì‹­ì´ëŒ€ì „',
    'ì‹¸ìš°ëŠ” ì‚¬ì„œ', 'ìŒì„±ì˜ ìŒì–‘ì‚¬', 'ì¸ë¨¸ ì›Œì¦ˆ', 'ì“°ë¥´ë¼ë¯¸ ìš¸ ì ì—',

    # ã… ì´ˆì„± (ì£¼ìš” ì‘í’ˆë§Œ)
    'í•˜ë‚˜ì•¼ë§ˆíƒ€', 'í•˜ëŠ˜ì˜ ìœ ì‹¤ë¬¼', 'í•˜ë ˆêµ¬ìš°', 'í•˜ë£¨ì¹˜ì¹´', 'í•˜ë§ˆí† ë¼', 'í•˜ì•¼í…Œì²˜ëŸ¼!',
    'í•˜ìš¸ì˜ ì›€ì§ì´ëŠ” ì„±', 'í•˜ì´ìŠ¤ì¿¨ DÃ—D', 'í•˜ì´ìŠ¤ì½”ì–´ ê±¸', 'í•˜ì´í!!',
    'í•™êµê´´ë‹´', 'í•™êµìƒí™œ!', 'í•™ìƒíšŒ ì„ì›ë“¤', 'í•™ìƒíšŒì˜ ì¼ì¡´', 'í•™ì›ë¬µì‹œë¡ í•˜ì´ìŠ¤ì¿¨ ì˜¤ë¸Œ ë” ë°ë“œ',
    'í•™ì› ë² ì´ë¹„ì‹œí„°ì¦ˆ', 'í•™ì› ì•¨ë¦¬ìŠ¤', 'í•™ì „ë„ì‹œ ì• ìŠ¤í„°ë¦¬ìŠ¤í¬', 'í•¨ëŒ€ ì»¬ë ‰ì…˜',
    'í•´íŒŒë¦¬ ê³µì£¼', 'í•´í”¼ ìŠˆê°€ ë¼ì´í”„', 'í—ˆë‹ˆì™€ í´ë¡œë²„', 'í—Œí„°Ã—í—Œí„°', 'í—¤íƒ€ë¦¬ì•„',
    'í—¬ì‹±', 'í˜ëª…ê¸° ë°œë¸Œë ˆì´ë¸Œ', 'í˜ˆê³„ì „ì„ ', 'í˜¸ë¦¬ë¯¸ì•¼', 'í˜¸ì˜¤ì¦ˆí‚¤ì˜ ëƒ‰ì² ',
    'í™˜ìƒê²Œì„', 'íšŒë³µìˆ ì‚¬ì˜ ì¬ì‹œì‘', 'íšŒì¥ë‹˜ì€ ë©”ì´ë“œ ì‚¬ë§ˆ!', 'í›„ë¥´ì¸  ë°”ìŠ¤ì¼“',
    'íë¦° í•˜ëŠ˜ì— ì›ƒë‹¤', 'í‘ì§‘ì‚¬', 'íˆë‚˜ì½” ë…¸íŠ¸', 'íˆë‹¤ë§ˆë¦¬ ìŠ¤ì¼€ì¹˜', 'íˆì¹´ë£¨ì˜ ë°”ë‘‘',
]

# í•œêµ­ì–´ â†’ ì˜ì–´ í‚¤ì›Œë“œ ìë™ ìƒì„± ê·œì¹™
TITLE_MAPPINGS = {
    # ìë™ ë³€í™˜ì´ ì–´ë ¤ìš´ ê²½ìš°ë§Œ ìˆ˜ë™ ë§¤í•‘
    'ì‘ì•ˆì˜ ìƒ¤ë‚˜': ['shakugan', 'shana'],
    'ì”í–¥ì˜ í…ŒëŸ¬': ['zankyou', 'terror', 'resonance'],
    'ì¥ë‚œì„ ì˜ ì¹˜ëŠ” íƒ€ì¹´ê¸° ì–‘': ['takagi', 'karakai'],
    'ì¥ì†¡ì˜ í”„ë¦¬ë Œ': ['frieren', 'sousou'],
    'ì „ìƒí–ˆë”ë‹ˆ ìŠ¬ë¼ì„ì´ì—ˆë˜ ê±´ì— ëŒ€í•˜ì—¬': ['slime', 'tensei', 'tensura'],
    'ì „ì¥ì˜ ë°œíë¦¬ì•„': ['valkyria', 'senjou'],
    'ì „íŒŒë…€ì™€ ì²­ì¶˜ë‚¨': ['denpa', 'seishun'],
    'ì ˆëŒ€ê°€ë ¨ ì¹ ë“œëŸ°': ['zettai karen', 'children'],
    'ì ˆì›ì˜ í…œí˜ìŠ¤íŠ¸': ['zetsuen', 'tempest'],
    'ì •ë ¹ì‚¬ì˜ ê²€ë¬´': ['seirei tsukai', 'blade dance'],
    'ì •ë ¹ì˜ ìˆ˜í˜¸ì': ['seirei', 'moribito', 'guardian'],
    'ì œë¡œë¶€í„° ì‹œì‘í•˜ëŠ” ë§ˆë²•ì˜ ì„œ': ['zero kara', 'grimoire'],
    'ì œë¡œì˜ ì‚¬ì—­ë§ˆ': ['zero no tsukaima', 'familiar'],
    'ì¢€ë¹„ ëœë“œ ì‚¬ê°€': ['zombieland saga'],
    'ì¢…ë§ì˜ ì„¸ë¼í”„': ['owari no seraph', 'seraph'],
    'ì¢…ë§ì˜ ì´ì œíƒ€': ['izetta', 'shuumatsu'],
    'ì£¼ë¬¸ì€ í† ë¼ì…ë‹ˆê¹Œ?': ['gochiusa', 'usagi', 'rabbit'],
    'ì£¼ìˆ íšŒì „': ['jujutsu kaisen'],
    'ì¤‘2ë³‘ì´ë¼ë„ ì‚¬ë‘ì´ í•˜ê³  ì‹¶ì–´!': ['chuunibyou', 'demo koi'],
    'ì§€ê¸ˆ, ê±°ê¸°ì— ìˆëŠ” ë‚˜': ['ima soko', 'now and then'],
    'ì§€ë°•ì†Œë…„ í•˜ë‚˜ì½” êµ°': ['jibaku', 'hanako'],
    'ì§€ì˜¥ì†Œë…€': ['jigoku shoujo', 'hell girl'],
    'ì§€íŒ¡ì´ì™€ ê²€ì˜ ìœ„ìŠ¤í† ë¦¬ì•„': ['wistoria', 'tsue to tsurugi'],
    'ì§„ê²©ì˜ ê±°ì¸': ['shingeki', 'kyojin', 'attack on titan'],
    'ì§„ê²©! ê±°ì¸ ì¤‘í•™êµ': ['shingeki chuugakkou', 'junior high'],

    'ì•„ë¼ì¹´ì™€ ì–¸ë” ë” ë¸Œë¦¬ì§€': ['arakawa', 'bridge'],
    'ì•„ë¥´ìŠ¬ë€ ì „ê¸°': ['arslan'],
    'ì•„ë§ˆê°€ë¯¸': ['amagami'],
    'ì•„ë§ˆê¸° ë¸Œë¦´ë¦¬ì–¸íŠ¸ íŒŒí¬': ['amagi', 'brilliant'],
    'ì•„ì›ƒë¸Œë ˆì´í¬ ì»´í¼ë‹ˆ': ['outbreak company'],
    'ì•„ì´ëŒ ë§ˆìŠ¤í„°': ['idolmaster', 'im@s'],
    'ì•„ì´ì‹¤ë“œ 21': ['eyeshield'],
    'ì•„ì´ì¹´ì¸ ': ['aikatsu'],
    'ì•„ì¦ˆë§ê°€ ëŒ€ì™•': ['azumanga'],
    'ì•„ì¹´ë©”ê°€ ë²¤ë‹¤': ['akame ga kill'],
    'ì•„í”ˆ ê±´ ì‹«ìœ¼ë‹ˆê¹Œ ë°©ì–´ë ¥ì— ì˜¬ì¸í•˜ë ¤ê³  í•©ë‹ˆë‹¤': ['bofuri', 'bougyoryoku'],
    'ì•…ë§ˆì˜ ë¦¬ë“¤': ['akuma no riddle'],
    'ì•ˆë…• ì ˆë§ì„ ìƒ': ['sayonara zetsubou'],
    'ì•Œë“œë…¸ì•„': ['aldnoah'],
    'ì•Œë°” ë›°ëŠ” ë§ˆì™•ë‹˜': ['hataraku maou'],
    'ì•”ì‚´êµì‹¤': ['ansatsu kyoushitsu', 'assassination'],
    'ì•¡ì…€ ì›”ë“œ': ['accel world'],
    'ì•±ì†”ë£¨íŠ¸ ë“€ì˜¤': ['absolute duo'],
    'ì•¼ë§ˆë…¸ìŠ¤ìŠ¤ë©”': ['yama no susume'],
    'ì•¼ë§ˆë‹¤ì™€ 7ëª…ì˜ ë§ˆë…€': ['yamada kun', 'witch'],
    'ì•½ì†ì˜ ë„¤ë²„ëœë“œ': ['yakusoku', 'neverland', 'promised'],
    'ì–´ë‚˜ë”': ['another'],
    'ì–´ë‘ ê³¼ ëª¨ìì™€ ì±…ì˜ ì—¬í–‰ì': ['yamibou', 'kuro boushi'],
    'ì–´ë–¤ ë§ˆìˆ ì˜ ê¸ˆì„œëª©ë¡': ['toaru majutsu', 'index'],
    'ì–´ë–¤ ê³¼í•™ì˜ ì´ˆì „ìí¬': ['toaru kagaku', 'railgun'],
    'ì–´ì„œ ì˜¤ì„¸ìš” ì‹¤ë ¥ì§€ìƒì£¼ì˜ êµì‹¤ì—': ['youkoso jitsuryoku', 'classroom'],
    'ì–¸ë•ê¸¸ì˜ ì•„í´ë¡ ': ['sakamichi', 'apollon'],
    'ì–¸ì–´ì˜ ì •ì›': ['kotonoha', 'garden of words'],
    'ì—”ì ¤ ë¹„íŠ¸': ['angel beats'],
    'ì—˜íœë¦¬íŠ¸': ['elfen lied'],
    'ì—¬ê³ ìƒ ë°”ë³´êµ°ë‹¨': ['aho girl'],
    'ì—¬ê¸°ëŠ” ì˜ë‚˜ê°€ëŠ” íŒŒì¶œì†Œ': ['kochikame'],
    'ì—­ê²½ë¬´ë¢° ì¹´ì´ì§€': ['kaiji'],
    'ì—­ì‹œ ë‚´ ì²­ì¶˜ ëŸ¬ë¸Œì½”ë©”ë””ëŠ” ì˜ëª»ëë‹¤': ['yahari', 'oregairu'],
    'ì˜¤ë€ê³ êµ ì‚¬êµí´ëŸ½': ['ouran', 'host club'],
    'ì˜¤ë²„ë¡œë“œ': ['overlord'],
    'ì˜¤ì†Œë§ˆì¸  ìƒ': ['osomatsu'],
    'ì˜¤íƒ€ì¿ ì—ê²Œ ì‚¬ë‘ì€ ì–´ë ¤ì›Œ': ['wotaku', 'wotakoi'],
    'ì˜¨ë¼ì¸ ê²Œì„ì˜ ì‹ ë¶€ëŠ” ì—¬ìì•„ì´ê°€ ì•„ë‹ˆë¼ê³  ìƒê°í•œ ê±°ì•¼?': ['netoge', 'yome'],
    'ì™„ê°„ ë¯¸ë“œë‚˜ì´íŠ¸': ['wangan midnight'],
    'ì™•ì‹¤êµì‚¬ í•˜ì´ë„¤': ['oushitsu kyoushi', 'heine'],
    'ìš”ê´´ì›Œì¹˜': ['youkai watch'],
    'ìš”ë¥´ë¬¸ê°„ë“œ': ['jormungand'],
    'ìš”ìˆ ê³µì£¼ ìƒë¦¬': ['sally'],
    'ìš°ë¼ë¼ ë¯¸ë¡œì²©': ['urara meirochou'],
    'ìš°ë§ˆë¬´ìŠ¤ë©” í”„ë¦¬í‹° ë”ë¹„': ['uma musume'],
    'ìš¸ë ¤ë¼! ìœ í¬ë‹ˆì—„': ['hibike euphonium'],
    'ì›í€ë§¨': ['one punch man'],
    'ì›í”¼ìŠ¤': ['one piece'],
    'ì›”ê°„ìˆœì • ë…¸ìí‚¤ êµ°': ['gekkan shoujo', 'nozaki'],
    'ì›”ë“œ íŠ¸ë¦¬ê±°': ['world trigger'],
    'ìœ ë…€ì „ê¸°': ['youjo senki', 'saga of tanya'],
    'ìœ ë£¨ìœ ë¦¬': ['yuru yuri'],
    'ìœ ë£¨ìº í”„': ['yuru camp'],
    'ìœ ë¦¬!!!': ['yuri on ice'],
    'ìœ ìœ ë°±ì„œ': ['yuu yuu hakusho', 'yuyu'],
    'ìœ í¬ì™•': ['yugioh', 'yu-gi-oh'],
    'ì€ìˆ˜ì €': ['gin no saji', 'silver spoon'],
    'ì€í•˜ì˜ì›…ì „ì„¤': ['ginga eiyuu', 'legend galactic'],
    'ì€í•˜ì² ë„ 999': ['galaxy express'],
    'ì€í˜¼': ['gintama'],
    'ì´ë‚˜ì¦ˆë§ˆ ì¼ë ˆë¸': ['inazuma eleven'],
    'ì´ëˆ„ì•¼ìƒ¤': ['inuyasha'],
    'ì´ ë©‹ì§„ ì„¸ê³„ì— ì¶•ë³µì„': ['konosuba', 'kono subarashii'],
    'ì´ì„¸ê³„ ì‹ë‹¹': ['isekai shokudou', 'restaurant'],
    'ì´ì„¸ê³„ëŠ” ìŠ¤ë§ˆíŠ¸í°ê³¼ í•¨ê»˜': ['isekai smartphone'],
    'ì´ì„¸ê³„ ë§ˆì™•ê³¼ ì†Œí™˜ ì†Œë…€ì˜ ë…¸ì˜ˆ ë§ˆìˆ ': ['isekai maou', 'demon lord'],
    'ì´ì•¼ê¸° ì‹œë¦¬ì¦ˆ': ['monogatari'],
    'ì´ì›ƒì§‘ í† í† ë¡œ': ['totoro', 'tonari'],
    'ì´ìœ½ê³  ë„¤ê°€ ëœë‹¤': ['yagate kimi', 'bloom into you'],
    'ì¸ë¥˜ëŠ” ì‡ í‡´í–ˆìŠµë‹ˆë‹¤': ['jinrui', 'humanity has declined'],
    'ì¼ê³± ê°œì˜ ëŒ€ì£„': ['nanatsu no taizai', 'seven deadly'],
    'ì¼ê¸°ë‹¹ì²œ': ['ikkitousen'],
    'ì¼ìƒ': ['nichijou'],
    'ì„ê¸ˆë‹˜ ë­í‚¹': ['ousama ranking'],

    'ì‚¬ë‘ê³¼ ê±°ì§“ë§': ['koi to uso'],
    'ì‚¬ë‘ê³¼ ì„ ê±°ì™€ ì´ˆì½œë¦¿': ['koi to senkyo', 'chocolate'],
    'ì‚¬ë‘ì€ ë¹„ê°€ ê°  ë’¤ì²˜ëŸ¼': ['koi wa ameagari'],
    'ì‚¬ë¬´ë¼ì´ 7': ['samurai 7'],
    'ì‚¬ë¬´ë¼ì´ ì°¸í”„ë£¨': ['samurai champloo'],
    'ì‚¬ë¬´ë¼ì´ í”Œë¼ë©©ì½”': ['samurai flamenco'],
    'ì‚¬ìƒìµœê°•ì˜ ì œì ì¼„ì´ì¹˜': ['kenichi', 'shijou saikyou'],
    'ì‚¬ì´ë³´ê·¸ 009': ['cyborg 009'],
    'ì‚¬ì´ì½” íŒ¨ìŠ¤': ['psycho pass'],
    'ì‚¬ì´í‚¤ ì¿ ìŠ¤ì˜¤ì˜ ì¬ë‚œ': ['saiki kusuo'],
    'ì‚¬ì¹´ëª¨í† ì…ë‹ˆë‹¤ë§Œ': ['sakamoto desu ga'],
    'ì‚¬í‚¤': ['saki'],
    'ì‚¬ì¿ ë¼ ëŒ€ì „': ['sakura taisen', 'wars'],
    'ì‚¬ì¿ ë¼ì¥ì˜ ì• ì™„ ê·¸ë…€': ['sakurasou', 'pet'],
    'ì‚°ì¹´ë ˆì•„': ['sankarea'],
    'ì‚´ìœ¡ì˜ ì²œì‚¬': ['satsuriku', 'angels of death'],
    'ì‚¼ìì‚¼ì—½': ['sansha sanyou'],
    'ìƒˆë²½ì˜ ì—°í™”': ['akatsuki no yona'],
    'ìƒ¤ë¨¼í‚¹': ['shaman king'],
    'ìƒ¤ë¥¼ë¡œíŠ¸': ['charlotte'],
    'ìƒ¹ê·¸ë¦¬ë¼': ['shangri-la'],
    'ì„€ë„ í•˜ìš°ìŠ¤': ['shadows house'],
    'ì„¬ê´‘ì˜ ë‚˜ì´íŠ¸ë ˆì´ë“œ': ['senkou', 'night raid'],
    'ì„¬ë€ ì¹´êµ¬ë¼': ['senran kagura'],
    'ì„±ê²€ì‚¬ì˜ ê¸ˆì£¼ì˜ì°½': ['seiken tsukai', 'world break'],
    'ì„¸ê¸°ë§ ì˜¤ì»¬íŠ¸ í•™ì›': ['occult gakuin'],
    'ì„¸ê³„ì •ë³µ': ['sekai seifuku', 'zvezda'],
    'ì„¸ì´ë Œ': ['seiren'],
    'ì„¸ì¸íŠ¸ ì„¸ì´ì•¼': ['saint seiya'],
    'ì„¸ì¼ëŸ¬ ë¬¸': ['sailor moon'],
    'ì„¸í‚¤ë ˆì´': ['sekirei'],
    'ì„¸í† ì˜ ì‹ ë¶€': ['seto no hanayome'],
    'ì„¼ê³¼ ì¹˜íˆë¡œì˜ í–‰ë°©ë¶ˆëª…': ['sen to chihiro', 'spirited away'],
    'ì†Œë…€ì¢…ë§ì—¬í–‰': ['shoujo shuumatsu', 'girls last tour'],
    'ì†Œë…€í˜ëª… ìš°í…Œë‚˜': ['shoujo kakumei utena'],
    'ì†Œë…„íƒì • ê¹€ì „ì¼': ['kindaichi'],
    'ì†Œë“œ ì•„íŠ¸ ì˜¨ë¼ì¸': ['sword art online', 'sao'],
    'ì†Œìš¸ ì´í„°': ['soul eater'],
    'ì‡¼ì™€ ê²ë¡œì¿  ë¼ì¿ ê³  ì‹¬ì¤‘': ['shouwa genroku', 'rakugo'],
    'ìˆ˜í˜¸ìºë¦­í„°': ['shugo chara'],
    'ìŠˆíƒ€ì¸ì¦ˆ ê²Œì´íŠ¸': ['steins gate'],
    'ìŠ¤ì¼“ ëŒ„ìŠ¤': ['sket dance'],
    'ìŠ¤ì¿¨ëŸ¼ë¸”': ['school rumble'],
    'ìŠ¤í¬ë¼ì´ë“œ': ['scryed'],
    'ìŠ¤íƒ€ë®¤': ['starmyu'],
    'ìŠ¤íŠ¸ë¼ì´í¬ ìœ„ì¹˜ìŠ¤': ['strike witches'],
    'ìŠ¤íŒŒì´ êµì‹¤': ['spy kyoushitsu', 'classroom'],
    'ìŠ¤íŒŒì´ íŒ¨ë°€ë¦¬': ['spy family'],
    'ìŠ¬ë¨ë©í¬': ['slam dunk'],
    'ìŠ¬ë ˆì´ì–´ì¦ˆ': ['slayers'],
    'ì‹œê°„ì„ ë‹¬ë¦¬ëŠ” ì†Œë…€': ['toki wo kakeru', 'girl who leapt'],
    'ì‹œê·€': ['shiki'],
    'ì‹œëŒë³„ ë…€ì„ë“¤': ['urusei yatsura'],
    'ì‹œë„ë‹ˆì•„ì˜ ê¸°ì‚¬': ['sidonia', 'knights'],
    'ì‹œë¡œë°”ì½”': ['shirobako'],
    'ì‹­ì´êµ­ê¸°': ['juuni kokuki', 'twelve kingdoms'],
    'ì‹­ì´ëŒ€ì „': ['juuni taisen'],
    'ì‹¸ìš°ëŠ” ì‚¬ì„œ': ['tatakau shisho', 'armed librarians'],
    'ìŒì„±ì˜ ìŒì–‘ì‚¬': ['sousei no onmyouji', 'twin star'],
    'ì¸ë¨¸ ì›Œì¦ˆ': ['summer wars'],
    'ì“°ë¥´ë¼ë¯¸ ìš¸ ì ì—': ['higurashi'],

    'í•˜ë‚˜ì•¼ë§ˆíƒ€': ['hanayamata'],
    'í•˜ëŠ˜ì˜ ìœ ì‹¤ë¬¼': ['sora no otoshimono'],
    'í•˜ë ˆêµ¬ìš°': ['hareguu'],
    'í•˜ë£¨ì¹˜ì¹´': ['haruchika'],
    'í•˜ë§ˆí† ë¼': ['hamatora'],
    'í•˜ì•¼í…Œì²˜ëŸ¼': ['hayate no gotoku'],
    'í•˜ìš¸ì˜ ì›€ì§ì´ëŠ” ì„±': ['howl', 'moving castle'],
    'í•˜ì´ìŠ¤ì½”ì–´ ê±¸': ['high score girl'],
    'í•˜ì´í': ['haikyuu', 'volleyball'],
    'í•™êµê´´ë‹´': ['gakkou no kaidan', 'ghost stories'],
    'í•™êµìƒí™œ': ['gakkou gurashi', 'school live'],
    'í•™ìƒíšŒ ì„ì›ë“¤': ['seitokai yakuindomo'],
    'í•™ìƒíšŒì˜ ì¼ì¡´': ['seitokai no ichizon'],
    'í•™ì›ë¬µì‹œë¡': ['gakuen mokushiroku', 'highschool of the dead'],
    'í•™ì› ë² ì´ë¹„ì‹œí„°ì¦ˆ': ['gakuen babysitters'],
    'í•™ì› ì•¨ë¦¬ìŠ¤': ['gakuen alice'],
    'í•¨ëŒ€ ì»¬ë ‰ì…˜': ['kantai collection', 'kancolle'],
    'í•´íŒŒë¦¬ ê³µì£¼': ['kuragehime', 'princess jellyfish'],
    'í•´í”¼ ìŠˆê°€ ë¼ì´í”„': ['happy sugar life'],
    'í—ˆë‹ˆì™€ í´ë¡œë²„': ['honey and clover'],
    'í—Œí„°Ã—í—Œí„°': ['hunter x hunter', 'hunterxhunter'],
    'í—¤íƒ€ë¦¬ì•„': ['hetalia'],
    'í—¬ì‹±': ['hellsing'],
    'í˜ëª…ê¸° ë°œë¸Œë ˆì´ë¸Œ': ['kakumeiki valvrave'],
    'í˜ˆê³„ì „ì„ ': ['kekkai sensen', 'blood blockade'],
    'í˜¸ë¦¬ë¯¸ì•¼': ['horimiya'],
    'í˜¸ì˜¤ì¦ˆí‚¤ì˜ ëƒ‰ì² ': ['hoozuki no reitetsu'],
    'í™˜ìƒê²Œì„': ['fushigi yuugi'],
    'íšŒë³µìˆ ì‚¬ì˜ ì¬ì‹œì‘': ['kaifuku', 'redo of healer'],
    'íšŒì¥ë‹˜ì€ ë©”ì´ë“œ ì‚¬ë§ˆ': ['kaichou wa maid'],
    'í›„ë¥´ì¸  ë°”ìŠ¤ì¼“': ['fruits basket', 'furuba'],
    'íë¦° í•˜ëŠ˜ì— ì›ƒë‹¤': ['donten', 'laughing under clouds'],
    'í‘ì§‘ì‚¬': ['kuroshitsuji', 'black butler'],
    'íˆë‚˜ì½” ë…¸íŠ¸': ['hinako note'],
    'íˆë‹¤ë§ˆë¦¬ ìŠ¤ì¼€ì¹˜': ['hidamari sketch'],
    'íˆì¹´ë£¨ì˜ ë°”ë‘‘': ['hikaru no go'],
}

def normalize_text(text):
    """í…ìŠ¤íŠ¸ ì •ê·œí™”"""
    if not text:
        return ""
    text = text.lower()
    # íŠ¹ìˆ˜ë¬¸ì ì œê±°, ê³µë°±ìœ¼ë¡œ ì¹˜í™˜
    text = re.sub(r'[^a-z0-9\s]', ' ', text)
    text = re.sub(r'\s+', ' ', text).strip()
    return text

def get_keywords(korean_title):
    """í•œêµ­ì–´ ì œëª©ì—ì„œ í‚¤ì›Œë“œ ì¶”ì¶œ"""
    if korean_title in TITLE_MAPPINGS:
        return TITLE_MAPPINGS[korean_title]

    # ë§¤í•‘ì— ì—†ìœ¼ë©´ ì œëª©ì„ ë‹¨ì–´ë¡œ ë¶„ë¦¬í•´ì„œ ì‚¬ìš©
    # ì˜ˆ: "ì§„ê²©ì˜ ê±°ì¸" -> ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ë¶€ë¶„ ë§¤ì¹­
    return []

def fuzzy_match(korean_title, romaji, english):
    """í¼ì§€ ë§¤ì¹­"""
    keywords = get_keywords(korean_title)

    if not keywords:
        return False

    romaji_norm = normalize_text(romaji) if romaji else ""
    english_norm = normalize_text(english) if english else ""

    for keyword in keywords:
        keyword_norm = normalize_text(keyword)
        if keyword_norm and (keyword_norm in romaji_norm or keyword_norm in english_norm):
            return True

    return False

def main():
    conn = sqlite3.connect(DB_PATH)
    cursor = conn.cursor()

    print(f"\në‚˜ë¬´ìœ„í‚¤ ëŒ€ëŸ‰ ì œëª© ë§¤ì¹­ ì‹œì‘ ({len(NAMU_TITLES)}ê°œ)...\n")

    # í•œêµ­ì–´ ì œëª©ì´ ê³µì‹ì´ ì•„ë‹Œ ì• ë‹ˆë©”ì´ì…˜ ì¡°íšŒ
    cursor.execute("""
        SELECT id, title_romaji, title_english, title_korean
        FROM anime
        WHERE title_korean_official = 0
        ORDER BY popularity DESC
    """)

    anime_list = cursor.fetchall()
    updated = 0
    skipped = 0

    for korean_title in NAMU_TITLES:
        matched = False

        for anime_id, romaji, english, current_korean in anime_list:
            if fuzzy_match(korean_title, romaji, english):
                # ì—…ë°ì´íŠ¸
                cursor.execute("""
                    UPDATE anime
                    SET title_korean = ?, title_korean_official = 1
                    WHERE id = ?
                """, (korean_title, anime_id))

                print(f"ğŸ”µ {anime_id}: {romaji} â†’ {korean_title}")
                updated += 1
                matched = True
                break

        if not matched:
            skipped += 1

    conn.commit()

    # í˜„ì¬ ê³µì‹ ì œëª© ì´ ê°œìˆ˜ í™•ì¸
    cursor.execute("SELECT COUNT(*) FROM anime WHERE title_korean_official = 1")
    total_official = cursor.fetchone()[0]

    conn.close()

    print(f"\n{'='*60}")
    print(f"ë‚˜ë¬´ìœ„í‚¤ ëŒ€ëŸ‰ ë§¤ì¹­ ì™„ë£Œ!")
    print(f"{'='*60}")
    print(f"  ë§¤ì¹­ ì„±ê³µ: {updated}ê°œ")
    print(f"  ìŠ¤í‚µ: {skipped}ê°œ")
    print(f"  ì´ ê³µì‹ ì œëª©: {total_official}ê°œ")
    print(f"{'='*60}\n")

if __name__ == '__main__':
    main()
